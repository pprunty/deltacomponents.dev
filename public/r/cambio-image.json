{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "cambio-image",
  "type": "registry:component",
  "author": "patrick prunty <https://www.patrickprunty.com>",
  "files": [
    {
      "path": "registry/media/cambio-image.tsx",
      "content": "\"use client\"\n\nimport { useEffect, useRef, useState } from \"react\"\nimport { Cambio } from \"cambio\"\n\ntype MotionPreset = \"snappy\" | \"smooth\" | \"bouncy\" | \"reduced\"\n\ninterface CambioImageProps {\n  src: string\n  alt: string\n  width: number\n  height: number\n  loading?: \"lazy\" | \"eager\"\n  index?: number\n  motion?:\n    | MotionPreset\n    | {\n        trigger?: MotionPreset\n        popup?: MotionPreset\n        backdrop?: MotionPreset\n      }\n  dismissible?: boolean\n}\n\nexport default function CambioImage({\n  src,\n  alt,\n  width,\n  height,\n  loading = \"lazy\",\n  index = 0,\n  motion = \"smooth\",\n  dismissible = true,\n}: CambioImageProps) {\n  const [isVisible, setIsVisible] = useState(false)\n\n  /* NEW — track the zoom state */\n  const [open, setOpen] = useState(false)\n  const ref = useRef<HTMLDivElement>(null)\n\n  /* Grace-period so the close animation can finish on top */\n  const handleOpenChange = (o: boolean) => {\n    setOpen(true) // keep it on top immediately\n    if (!o) setTimeout(() => setOpen(false), 400) // default \"smooth\" preset ≈ 300 ms\n  }\n\n  useEffect(() => {\n    const io = new IntersectionObserver(\n      ([e]) => {\n        if (e.isIntersecting) {\n          setIsVisible(true)\n          io.disconnect()\n        }\n      },\n      { threshold: 0.1 }\n    )\n    if (ref.current) {\n      io.observe(ref.current)\n    }\n    return () => io.disconnect()\n  }, [])\n\n  /* Massive z-index only while the item is zooming/closing */\n  const zIndex = open ? 999 : 10 + index\n\n  return (\n    <div\n      ref={ref}\n      className=\"relative transition-all duration-500 ease-out\"\n      style={{\n        opacity: isVisible ? 1 : 0,\n        filter: isVisible ? \"blur(0)\" : \"blur(4px)\",\n        zIndex,\n      }}\n    >\n      {/* @ts-ignore */}\n      <Cambio.Root\n        motion={motion}\n        dismissible={dismissible}\n        open={open}\n        onOpenChange={handleOpenChange}\n      >\n        {/* @ts-ignore */}\n        <Cambio.Trigger className=\"relative w-full cursor-zoom-in overflow-hidden\">\n          <img\n            src={src}\n            alt={alt}\n            width={width}\n            height={height}\n            loading={loading}\n            className=\"w-full h-auto\"\n            style={{ pointerEvents: \"none\" }}\n          />\n        </Cambio.Trigger>\n\n        {/* @ts-ignore */}\n        <Cambio.Portal>\n          {/* @ts-ignore */}\n          <Cambio.Backdrop className=\"fixed inset-0 bg-black/40 z-[100]\" />\n          {/* @ts-ignore */}\n          <Cambio.Popup className=\"w-full md:w-[70%] overflow-hidden z-[101]\">\n            <img\n              src={src}\n              alt={alt}\n              width={width}\n              height={height}\n              loading=\"eager\"\n              className=\"w-full h-auto object-contain\"\n              style={{ pointerEvents: \"none\" }}\n            />\n          </Cambio.Popup>\n        </Cambio.Portal>\n      </Cambio.Root>\n    </div>\n  )\n}\n",
      "type": "registry:component",
      "target": "components/delta/cambio-image.tsx"
    }
  ]
}