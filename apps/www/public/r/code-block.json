{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "code-block",
  "type": "registry:ui",
  "dependencies": [
    "lucide-react",
    "prism-react-renderer",
    "prismjs"
  ],
  "registryDependencies": [
    "copy-button",
    "tabs"
  ],
  "files": [
    {
      "path": "delta/code-block.tsx",
      "content": "\"use client\"\n\nimport * as React from \"react\"\nimport { useEffect, useState } from \"react\"\nimport { TerminalIcon } from \"lucide-react\"\nimport { Highlight, Prism } from \"prism-react-renderer\"\nimport type { PrismTheme } from \"prism-react-renderer\"\n\n// Import additional language definitions\n\nimport { cn } from \"@/lib/utils\"\nimport { CopyButton } from \"@/registry/delta-ui/delta/copy-button\"\nimport {\n  Tabs,\n  TabsContent,\n  TabsList,\n  TabsTrigger,\n} from \"@/components/ui/tabs\"\n\n  ; (typeof global !== \"undefined\" ? global : window).Prism = Prism\nrequire(\"prismjs/components/prism-cpp\")\nrequire(\"prismjs/components/prism-python\")\nrequire(\"prismjs/components/prism-bash\")\nrequire(\"prismjs/components/prism-typescript\")\nrequire(\"prismjs/components/prism-javascript\")\nrequire(\"prismjs/components/prism-jsx\")\nrequire(\"prismjs/components/prism-tsx\")\nrequire(\"prismjs/components/prism-go\")\nrequire(\"prismjs/components/prism-rust\")\n\ntype PackageManager = \"npm\" | \"yarn\" | \"pnpm\" | \"bun\"\n\n// Inline theme definitions\nconst defaultTheme: PrismTheme = {\n  plain: {\n    color: \"#FFFFFF\",\n    backgroundColor: \"#161616\",\n  },\n  styles: [\n    {\n      types: [\"comment\"],\n      style: {\n        color: \"#757575\",\n        fontStyle: \"italic\",\n      },\n    },\n    {\n      types: [\"keyword\", \"property\", \"property-access\", \"attr-name\"],\n      style: {\n        color: \"#77b7d7\",\n      },\n    },\n    {\n      types: [\"tag\"],\n      style: {\n        color: \"#dfab5c\",\n      },\n    },\n    {\n      types: [\"punctuation\", \"symbol\", \"dom\"],\n      style: {\n        color: \"#ffffff\",\n      },\n    },\n    {\n      types: [\"definition\", \"function\"],\n      style: {\n        color: \"#86d9ca\",\n      },\n    },\n    {\n      types: [\"string\", \"char\", \"attr-value\"],\n      style: {\n        color: \"#977cdc\",\n      },\n    },\n    {\n      types: [\"static\", \"number\"],\n      style: {\n        color: \"#ff6658\",\n      },\n    },\n  ],\n}\n\nconst lightTheme: PrismTheme = {\n  plain: {\n    color: \"#24292e\",\n    backgroundColor: \"#F9F9F9\",\n  },\n  styles: [\n    {\n      types: [\"comment\"],\n      style: {\n        color: \"#8b949e\",\n        fontStyle: \"italic\",\n      },\n    },\n    {\n      types: [\"variable\", \"parameter\"],\n      style: {\n        color: \"#e36209\",\n      },\n    },\n    {\n      types: [\"keyword\", \"builtin\", \"function-definition\"],\n      style: {\n        color: \"#d73a49\",\n      },\n    },\n    {\n      types: [\"property\", \"property-access\", \"attr-name\"],\n      style: {\n        color: \"#005cc5\",\n      },\n    },\n    {\n      types: [\"tag\"],\n      style: {\n        color: \"#22863a\",\n      },\n    },\n    {\n      types: [\"punctuation\", \"symbol\", \"dom\", \"operator\"],\n      style: {\n        color: \"#24292e\",\n      },\n    },\n    {\n      types: [\"function\"],\n      style: {\n        color: \"#6f42c1\",\n      },\n    },\n    {\n      types: [\"class-name\"],\n      style: {\n        color: \"#6f42c1\",\n      },\n    },\n    {\n      types: [\"string\", \"char\", \"attr-value\"],\n      style: {\n        color: \"#032f62\",\n      },\n    },\n    {\n      types: [\"static\", \"number\"],\n      style: {\n        color: \"#005cc5\",\n      },\n    },\n  ],\n}\n\ninterface CodeBlockProps {\n  // Package manager commands\n  npm?: string\n  yarn?: string\n  pnpm?: string\n  bun?: string\n  defaultPackageManager?: PackageManager\n\n  // Code highlighting props\n  code?: string\n  css?: string\n  language?: string\n  defaultLanguage?: string\n  filename?: string\n  showLineNumbers?: boolean\n  theme?: PrismTheme\n  adaptiveTheme?: {\n    light: PrismTheme\n    dark: PrismTheme\n  }\n\n  // Background options\n  useThemeBackground?: boolean // When true, uses the JSON theme background; when false, uses bg-surface\n\n  className?: string\n}\n\nexport function CodeBlock({\n  npm,\n  yarn,\n  pnpm,\n  bun,\n  defaultPackageManager = \"npm\",\n  code,\n  css,\n  language = \"typescript\",\n  defaultLanguage,\n  filename,\n  showLineNumbers = true,\n  theme,\n  adaptiveTheme,\n  useThemeBackground = false,\n  className,\n}: CodeBlockProps) {\n  const [packageManager, setPackageManager] = React.useState<PackageManager>(\n    defaultPackageManager\n  )\n  const [isDark, setIsDark] = useState(false)\n\n  // Hook to detect dark mode\n  useEffect(() => {\n    const checkDarkMode = () => {\n      setIsDark(document.documentElement.classList.contains(\"dark\"))\n    }\n\n    checkDarkMode()\n\n    const observer = new MutationObserver((mutations) => {\n      mutations.forEach((mutation) => {\n        if (\n          mutation.type === \"attributes\" &&\n          mutation.attributeName === \"class\"\n        ) {\n          checkDarkMode()\n        }\n      })\n    })\n\n    observer.observe(document.documentElement, {\n      attributes: true,\n      attributeFilter: [\"class\"],\n    })\n\n    return () => observer.disconnect()\n  }, [])\n\n  const commands = React.useMemo(() => {\n    return {\n      npm,\n      yarn,\n      pnpm,\n      bun,\n    }\n  }, [npm, yarn, pnpm, bun])\n\n  const availableCommands = Object.entries(commands).filter(\n    ([, command]) => command\n  )\n\n  // Select theme based on adaptiveTheme prop or auto-detect light/dark mode\n  const selectedTheme = adaptiveTheme\n    ? isDark\n      ? adaptiveTheme.dark\n      : adaptiveTheme.light\n    : theme || (isDark ? defaultTheme : lightTheme)\n\n  // Use the theme's text foreground color for the copy button\n  const iconColor = selectedTheme.plain?.color || \"#000000\"\n\n  // Handle CSS prop - treat as code with CSS language\n  const actualCode = css || code\n  const actualLanguage = css ? \"css\" : defaultLanguage || language\n\n  // If we have package manager commands, show the tabbed interface\n  if (availableCommands.length > 0) {\n    return (\n      <div\n        className={cn(\n          \"bg-card text-card-foreground overflow-x-auto rounded-lg border\",\n          className\n        )}\n        data-slot=\"tabs\"\n      >\n        <Tabs\n          value={packageManager}\n          className=\"gap-0\"\n          onValueChange={(value) => setPackageManager(value as PackageManager)}\n        >\n          <div\n            className={cn(\n              \"flex items-center justify-between border-b px-3 py-1\",\n              !useThemeBackground && \"bg-surface\"\n            )}\n            style={\n              useThemeBackground\n                ? {\n                  backgroundColor: selectedTheme.plain?.backgroundColor,\n                }\n                : undefined\n            }\n          >\n            <div className=\"flex items-center gap-2\">\n              <div className=\"bg-foreground flex size-4 items-center justify-center rounded-[1px] opacity-70\">\n                <TerminalIcon className=\"text-code size-3\" />\n              </div>\n              <TabsList className=\"rounded-none bg-transparent p-0\">\n                {availableCommands.map(([key]) => (\n                  <TabsTrigger\n                    key={key}\n                    value={key}\n                    className=\"h-7 border border-transparent rounded-sm pt-0.5 data-[state=active]:border-border data-[state=active]:bg-transparent data-[state=active]:shadow-none\"\n                  >\n                    {key}\n                  </TabsTrigger>\n                ))}\n              </TabsList>\n            </div>\n            <CopyButton\n              value={commands[packageManager] || \"\"}\n              className=\"size-7 opacity-70 hover:opacity-100 focus-visible:opacity-100\"\n              tooltip=\"Copy command\"\n            />\n          </div>\n          <div className=\"no-scrollbar overflow-x-auto\">\n            {availableCommands.map(([key, command]) => (\n              <TabsContent key={key} value={key} className=\"mt-0\">\n                <div\n                  className={cn(\n                    \"relative py-4\",\n                    !useThemeBackground && \"bg-surface\"\n                  )}\n                  style={\n                    useThemeBackground\n                      ? {\n                        backgroundColor: selectedTheme.plain?.backgroundColor,\n                      }\n                      : undefined\n                  }\n                >\n                  <Highlight\n                    theme={selectedTheme}\n                    code={command || \"\"}\n                    language=\"bash\"\n                  >\n                    {({\n                      className: highlightClassName,\n                      style,\n                      tokens,\n                      getLineProps,\n                      getTokenProps,\n                    }) => (\n                      <pre\n                        className={`${highlightClassName} w-full overflow-x-auto px-4 font-mono text-sm leading-relaxed font-medium`}\n                        style={{\n                          ...style,\n                          backgroundColor: useThemeBackground\n                            ? selectedTheme.plain?.backgroundColor\n                            : 'transparent',\n                          fontSize: className?.includes(\"text-lg\")\n                            ? \"1.125rem\"\n                            : className?.includes(\"text-base\")\n                              ? \"1rem\"\n                              : undefined,\n                        }}\n                      >\n                        {tokens.map((line, i) => (\n                          <div key={i} {...getLineProps({ line })}>\n                            {line.map((token, key) => (\n                              <span key={key} {...getTokenProps({ token })} />\n                            ))}\n                          </div>\n                        ))}\n                      </pre>\n                    )}\n                  </Highlight>\n                </div>\n              </TabsContent>\n            ))}\n          </div>\n        </Tabs>\n      </div>\n    )\n  }\n\n  // If we have code to highlight, show the syntax highlighted version\n  if (actualCode) {\n    return (\n      <div\n        className={cn(\n          \"border-border pointer-events-auto w-full max-w-full overflow-x-auto overflow-y-hidden rounded-sm border\",\n          className\n        )}\n      >\n        {filename && (\n          <div\n            className={cn(\n              \"flex items-center justify-between border-b\",\n              !useThemeBackground && \"bg-surface\"\n            )}\n            style={\n              useThemeBackground\n                ? {\n                  backgroundColor: selectedTheme.plain?.backgroundColor,\n                }\n                : undefined\n            }\n          >\n            <div className=\"flex items-center gap-2 px-3 py-1\">\n              <span className=\"text-sm font-medium\">{filename}</span>\n            </div>\n            <CopyButton\n              value={actualCode}\n              className=\"mr-3\"\n              tooltip=\"Copy code\"\n            />\n          </div>\n        )}\n\n        <div\n          className={cn(\n            \"relative max-h-[calc(530px-44px)] w-full py-4\",\n            !useThemeBackground && \"bg-surface\"\n          )}\n          style={\n            useThemeBackground\n              ? {\n                backgroundColor: selectedTheme.plain?.backgroundColor,\n              }\n              : undefined\n          }\n        >\n          {!filename && (\n            <div className=\"absolute top-1 right-1\">\n              <CopyButton value={actualCode} tooltip=\"Copy code\" />\n            </div>\n          )}\n\n          <Highlight\n            theme={selectedTheme}\n            code={actualCode.trim()}\n            language={actualLanguage}\n          >\n            {({\n              className: highlightClassName,\n              style,\n              tokens,\n              getLineProps,\n              getTokenProps,\n            }) => (\n              <pre\n                className={`${highlightClassName} thin-scrollbar max-h-[calc(530px-88px)] w-full overflow-x-auto overflow-y-auto font-mono text-sm leading-relaxed font-medium`}\n                style={{\n                  ...style,\n                  backgroundColor: useThemeBackground\n                    ? selectedTheme.plain?.backgroundColor\n                    : 'transparent',\n                  fontSize: className?.includes(\"text-lg\")\n                    ? \"1.125rem\"\n                    : className?.includes(\"text-base\")\n                      ? \"1rem\"\n                      : undefined,\n                  scrollbarWidth: \"thin\",\n                  scrollbarColor:\n                    selectedTheme.plain?.backgroundColor?.toLowerCase() ===\n                      \"#ffffff\" ||\n                      selectedTheme.plain?.backgroundColor === \"#FAFAFA\"\n                      ? \"#d1d5db transparent\"\n                      : \"#4b5563 transparent\",\n                }}\n              >\n                {tokens.map((line, i) => (\n                  <div\n                    key={i}\n                    {...getLineProps({ line })}\n                    className=\"flex items-center px-4 py-px\"\n                  >\n                    {showLineNumbers && (\n                      <span\n                        className=\"mr-4 flex items-center text-right text-sm select-none\"\n                        style={{\n                          color:\n                            selectedTheme.plain?.backgroundColor ===\n                              \"#FFFFFF\" ||\n                              selectedTheme.plain?.backgroundColor === \"#FAFAFA\"\n                              ? \"#999999\"\n                              : \"#757575\",\n                          minWidth: \"1.5rem\",\n                          fontSize: className?.includes(\"text-lg\")\n                            ? \"1.125rem\"\n                            : className?.includes(\"text-base\")\n                              ? \"1rem\"\n                              : undefined,\n                        }}\n                      >\n                        {i + 1}\n                      </span>\n                    )}\n                    <span className={!showLineNumbers ? \"ml-0\" : \"\"}>\n                      {line.map((token, key) => (\n                        <span key={key} {...getTokenProps({ token })} />\n                      ))}\n                    </span>\n                  </div>\n                ))}\n              </pre>\n            )}\n          </Highlight>\n        </div>\n      </div>\n    )\n  }\n\n  // Return null if no content\n  return null\n}\n",
      "type": "registry:ui"
    }
  ]
}