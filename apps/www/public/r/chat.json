{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "chat",
  "type": "registry:ui",
  "dependencies": [
    "lucide-react",
    "streamdown",
    "motion"
  ],
  "registryDependencies": [
    "button",
    "avatar",
    "textarea",
    "dropdown-menu"
  ],
  "files": [
    {
      "path": "delta/chat.tsx",
      "content": "\"use client\"\n\nimport React, {\n  memo,\n  useCallback,\n  useMemo,\n  useRef,\n  useState,\n  type ComponentProps,\n} from \"react\"\nimport {\n  ArrowUp,\n  ArrowDown,\n  Bot,\n  ChevronDown,\n  FileText,\n  Paperclip,\n  User,\n  X,\n} from \"lucide-react\"\nimport { motion, useInView, UseInViewOptions } from \"motion/react\"\nimport { Streamdown } from \"streamdown\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/registry/shadcn/avatar\"\nimport { Button } from \"@/registry/shadcn/button\"\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuTrigger,\n} from \"@/registry/shadcn/dropdown-menu\"\nimport { Textarea } from \"@/registry/shadcn/textarea\"\n\n// Response Component\ntype ResponseProps = ComponentProps<typeof Streamdown>\n\nexport const ChatResponse = memo(\n  ({ className, children, ...props }: ResponseProps) => (\n    <Streamdown\n      className={cn(\n        \"size-full [&>*:first-child]:mt-0 [&>*:last-child]:mb-0\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n    </Streamdown>\n  ),\n  (prevProps, nextProps) => prevProps.children === nextProps.children\n)\n\nChatResponse.displayName = \"ChatResponse\"\n\n// Streaming Response Component\ninterface StreamingResponseProps {\n  content: string\n  streamDelay?: number\n  className?: string\n}\n\nexport function ChatStreamingResponse({\n  content,\n  streamDelay = 20,\n  className,\n}: StreamingResponseProps) {\n  const [displayedContent, setDisplayedContent] = useState(\"\")\n  const [isComplete, setIsComplete] = useState(false)\n  const [isMounted, setIsMounted] = useState(false)\n\n  React.useEffect(() => {\n    setIsMounted(true)\n  }, [])\n\n  React.useEffect(() => {\n    if (!isMounted) return\n\n    setDisplayedContent(\"\")\n    setIsComplete(false)\n\n    let currentIndex = 0\n    const interval = setInterval(() => {\n      if (currentIndex < content.length) {\n        setDisplayedContent(content.slice(0, currentIndex + 1))\n        currentIndex++\n      } else {\n        setIsComplete(true)\n        clearInterval(interval)\n      }\n    }, streamDelay)\n\n    return () => clearInterval(interval)\n  }, [content, streamDelay, isMounted])\n\n  if (!isMounted) {\n    return <ChatResponse className={className}>{content}</ChatResponse>\n  }\n\n  return (\n    <div\n      className={cn(\n        \"size-full [&>*:first-child]:mt-0 [&>*:last-child]:mb-0\",\n        className\n      )}\n    >\n      <Streamdown>{displayedContent}</Streamdown>\n      {!isComplete && <span className=\"animate-pulse\">â–Š</span>}\n    </div>\n  )\n}\n\n// Shimmering Text Component for Reasoning\ninterface ShimmeringTextProps {\n  text: string\n  duration?: number\n  delay?: number\n  repeat?: boolean\n  repeatDelay?: number\n  className?: string\n  startOnView?: boolean\n  once?: boolean\n  inViewMargin?: UseInViewOptions[\"margin\"]\n  spread?: number\n  color?: string\n  shimmerColor?: string\n}\n\nexport function ChatReasoning({\n  text,\n  duration = 2,\n  delay = 0,\n  repeat = true,\n  repeatDelay = 0.5,\n  className,\n  startOnView = true,\n  once = false,\n  inViewMargin,\n  spread = 2,\n  color,\n  shimmerColor,\n}: ShimmeringTextProps) {\n  const ref = useRef<HTMLSpanElement>(null)\n  const [isMounted, setIsMounted] = useState(false)\n  const isInView = useInView(ref, { once, margin: inViewMargin })\n\n  React.useEffect(() => {\n    setIsMounted(true)\n  }, [])\n\n  const dynamicSpread = useMemo(() => {\n    return text.length * spread\n  }, [text, spread])\n\n  const shouldAnimate = isMounted && (!startOnView || isInView)\n\n  if (!isMounted) {\n    return (\n      <span\n        ref={ref}\n        className={cn(\"text-muted-foreground relative inline-block\", className)}\n      >\n        {text}\n      </span>\n    )\n  }\n\n  return (\n    <motion.span\n      ref={ref}\n      className={cn(\n        \"relative inline-block bg-[length:250%_100%,auto] bg-clip-text text-transparent\",\n        \"[--base-color:var(--muted-foreground)] [--shimmer-color:var(--foreground)]\",\n        \"[background-repeat:no-repeat,padding-box]\",\n        \"[--shimmer-bg:linear-gradient(90deg,transparent_calc(50%-var(--spread)),var(--shimmer-color),transparent_calc(50%+var(--spread)))]\",\n        \"dark:[--base-color:var(--muted-foreground)] dark:[--shimmer-color:var(--foreground)]\",\n        className\n      )}\n      style={\n        {\n          \"--spread\": `${dynamicSpread}px`,\n          ...(color && { \"--base-color\": color }),\n          ...(shimmerColor && { \"--shimmer-color\": shimmerColor }),\n          backgroundImage: `var(--shimmer-bg), linear-gradient(var(--base-color), var(--base-color))`,\n        } as React.CSSProperties\n      }\n      initial={{\n        backgroundPosition: \"100% center\",\n        opacity: 0,\n      }}\n      animate={\n        shouldAnimate\n          ? {\n              backgroundPosition: \"0% center\",\n              opacity: 1,\n            }\n          : {}\n      }\n      transition={{\n        backgroundPosition: {\n          repeat: repeat ? Infinity : 0,\n          duration,\n          delay,\n          repeatDelay,\n          ease: \"linear\",\n        },\n        opacity: {\n          duration: 0.3,\n          delay,\n        },\n      }}\n    >\n      {text}\n    </motion.span>\n  )\n}\n\n// Model Interface\ninterface Model {\n  id: string\n  name: string\n  model: string\n}\n\n// Data attributes for targeting components with CSS\n// Use these data attributes to style components:\n// [data-chat=\"send-button\"] - Send button\n// [data-chat=\"model-selector\"] - Model selector dropdown\n// [data-chat=\"options\"] - Options container\n// [data-chat=\"prompt-input\"] - Prompt input container\n// [data-chat=\"textarea\"] - Textarea element\n\n// ChatSendButton Component\ninterface ChatSendButtonProps {\n  isDisabled: boolean\n  isLoading: boolean\n  className?: string\n}\n\nexport function ChatSendButton({\n  isDisabled,\n  isLoading,\n  className,\n}: ChatSendButtonProps) {\n  return (\n    <Button\n      type=\"submit\"\n      disabled={isDisabled}\n      size=\"icon\"\n      data-chat=\"send-button\"\n      className={cn(\n        \"bg-primary hover:bg-primary/90 h-8 w-8 rounded-full\",\n        isDisabled && \"cursor-not-allowed\",\n        className\n      )}\n    >\n      <ArrowUp className=\"h-4 w-4\" />\n    </Button>\n  )\n}\n\n// ChatModelSelector Component\ninterface ChatModelSelectorProps {\n  selectedModel: string\n  onModelChange: (modelId: string) => void\n  models: Model[]\n  className?: string\n}\n\nexport function ChatModelSelector({\n  selectedModel,\n  onModelChange,\n  models,\n  className,\n}: ChatModelSelectorProps) {\n  return (\n    <DropdownMenu>\n      <DropdownMenuTrigger asChild>\n        <button\n          className={cn(\n            \"focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:border-destructive aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 hover:text-accent-foreground text-muted-foreground/60 hover:bg-muted flex h-6 shrink-0 items-center justify-center gap-1 rounded-md bg-transparent px-2 text-sm font-medium whitespace-nowrap transition-all outline-none focus-visible:ring-[3px] disabled:pointer-events-none disabled:opacity-50 has-[>svg]:px-1.5 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4\",\n            className\n          )}\n          data-chat=\"model-selector\"\n          data-slot=\"popover-trigger\"\n          type=\"button\"\n          aria-haspopup=\"dialog\"\n        >\n          <span>\n            {models.find((model) => model.id === selectedModel)?.name ||\n              \"Select Model\"}\n          </span>\n          <ChevronDown className=\"text-muted-foreground h-3 w-3 opacity-60\" />\n        </button>\n      </DropdownMenuTrigger>\n      <DropdownMenuContent align=\"start\">\n        {models.map((model) => (\n          <DropdownMenuItem\n            key={model.id}\n            onClick={() => onModelChange(model.id)}\n            className=\"cursor-pointer\"\n          >\n            <div className=\"flex flex-col items-start\">\n              <span>{model.name}</span>\n              <span className=\"text-muted-foreground text-xs\">\n                {model.model}\n              </span>\n            </div>\n          </DropdownMenuItem>\n        ))}\n      </DropdownMenuContent>\n    </DropdownMenu>\n  )\n}\n\n// PromptInputButton Component\ninterface PromptInputButtonProps {\n  variant?: 'default' | 'ghost'\n  onClick?: () => void\n  children: React.ReactNode\n  className?: string\n}\n\nexport function PromptInputButton({\n  variant = 'ghost',\n  onClick,\n  children,\n  className,\n}: PromptInputButtonProps) {\n  return (\n    <Button\n      type=\"button\"\n      variant={variant}\n      size=\"icon\"\n      className={cn(\n        \"hover:bg-muted h-8 w-auto px-2 gap-1\",\n        className\n      )}\n      onClick={onClick}\n    >\n      {children}\n    </Button>\n  )\n}\n\n// ChatOptions Component\ninterface ChatOptionsProps {\n  children?: React.ReactNode\n  className?: string\n}\n\nexport function ChatOptions({ children, className }: ChatOptionsProps) {\n  if (!children) return null\n  \n  return (\n    <div className={cn(\"flex items-center gap-3\", className)} data-chat=\"options\">\n      {children}\n    </div>\n  )\n}\n\n// Message Interface\nexport interface ChatMessage {\n  id: string\n  role: \"user\" | \"assistant\"\n  content: string\n  isStreaming?: boolean\n  reasoning?: boolean\n  file?: {\n    name: string\n    type: string\n    url?: string\n    size?: number\n  }\n}\n\n// File Message Component\ninterface ChatFileMessageProps {\n  file: NonNullable<ChatMessage['file']>\n  className?: string\n}\n\nexport function ChatFileMessage({\n  file,\n  className,\n}: ChatFileMessageProps) {\n  const isImage = file.type.startsWith('image/')\n  \n  return (\n    <div className={cn(\"flex flex-row-reverse gap-3 mb-2\", className)}>\n      <Avatar className=\"h-8 w-8 rounded-sm\">\n        <AvatarImage src=\"https://patrickprunty.com/icon.webp\" />\n        <AvatarFallback>\n          <User className=\"h-4 w-4\" />\n        </AvatarFallback>\n      </Avatar>\n      <div className=\"ml-auto max-w-[80%] flex items-center gap-2\">\n        {isImage && file.url ? (\n          <div className=\"relative\">\n            <img\n              src={file.url}\n              alt={file.name}\n              className=\"max-w-[200px] max-h-[150px] rounded-lg border object-cover\"\n              style={{ aspectRatio: 'auto' }}\n            />\n          </div>\n        ) : (\n          <div className=\"bg-muted flex items-center gap-3 rounded-lg border p-3\">\n            <div className=\"bg-muted-foreground/20 flex h-10 w-10 items-center justify-center rounded\">\n              <FileText className=\"h-5 w-5\" />\n            </div>\n            <div className=\"flex flex-col\">\n              <span className=\"text-sm font-medium truncate max-w-[120px]\">{file.name}</span>\n              <span className=\"text-xs text-muted-foreground uppercase\">\n                {file.type.split('/')[1] || 'FILE'}\n              </span>\n            </div>\n          </div>\n        )}\n      </div>\n    </div>\n  )\n}\n\n// User Message Component\ninterface ChatUserMessageProps {\n  message: ChatMessage\n  userAvatar?: string\n  className?: string\n}\n\nexport function ChatUserMessage({\n  message,\n  userAvatar = \"https://patrickprunty.com/icon.webp\",\n  className,\n}: ChatUserMessageProps) {\n  return (\n    <div className={cn(\"flex flex-row-reverse gap-3\", className)}>\n      <Avatar className=\"h-8 w-8 rounded-sm\">\n        <AvatarImage src={userAvatar} />\n        <AvatarFallback>\n          <User className=\"h-4 w-4\" />\n        </AvatarFallback>\n      </Avatar>\n      <div className=\"bg-primary text-primary-foreground ml-auto max-w-[80%] rounded-lg px-3 py-2\">\n        <p className=\"text-sm whitespace-pre-wrap\">{message?.content}</p>\n      </div>\n    </div>\n  )\n}\n\n// Assistant Message Component\ninterface ChatAssistantMessageProps {\n  message: ChatMessage\n  className?: string\n}\n\nexport function ChatAssistantMessage({\n  message,\n  className,\n}: ChatAssistantMessageProps) {\n  return (\n    <div className={cn(\"flex flex-row gap-3\", className)}>\n      <div className={cn(\"w-full\", className)}>\n        <div className=\"[&>code]:bg-muted [&_div[data-streamdown='code-block']]:!bg-muted [&_div[data-streamdown='code-block']>pre]:!bg-muted text-sm [&>*]:my-1 [&>*:first-child]:mt-0 [&>*:last-child]:mb-0 [&>code]:rounded [&>code]:px-1\">\n          {message?.reasoning && (\n            <div className=\"text-muted-foreground mb-2\">\n              <ChatReasoning text=\"Thinking...\" className=\"text-xs\" />\n            </div>\n          )}\n          {message?.isStreaming ? (\n            <ChatStreamingResponse content={message.content} />\n          ) : (\n            <ChatResponse>{message?.content || \"\"}</ChatResponse>\n          )}\n        </div>\n      </div>\n    </div>\n  )\n}\n\n// Welcome Section Component\ninterface ChatWelcomeProps {\n  children?: React.ReactNode\n  className?: string\n}\n\nexport function ChatWelcome({ children, className }: ChatWelcomeProps) {\n  if (children) {\n    return (\n      <div className={cn(\"py-8 text-center\", className)}>\n        {children}\n      </div>\n    )\n  }\n\n  return (\n    <div className={cn(\"text-foreground py-8 text-center\", className)}>\n      <div className=\"bg-muted mx-auto mb-4 flex h-12 w-12 items-center justify-center rounded-full\">\n        <Bot className=\"h-6 w-6\" />\n      </div>\n      <h2 className=\"text-xl font-semibold\">What&apos;s new?</h2>\n    </div>\n  )\n}\n\n// Conversation Container Component (like Conversation)\ninterface ConversationProps {\n  children: React.ReactNode\n  className?: string\n}\n\nexport function Conversation({ children, className }: ConversationProps) {\n  return (\n    <div className={cn(\"flex h-full w-full flex-col\", className)}>\n      {children}\n    </div>\n  )\n}\n\n// Conversation Content Component\ninterface ConversationContentProps {\n  children: React.ReactNode\n  className?: string\n}\n\nexport function ConversationContent({ children, className }: ConversationContentProps) {\n  return (\n    <div\n      className={cn(\n        \"[&::-webkit-scrollbar-thumb]:bg-muted-foreground/40 hover:[&::-webkit-scrollbar-thumb]:bg-muted-foreground/60 flex-1 overflow-y-auto [&::-webkit-scrollbar]:w-[6px] [&::-webkit-scrollbar-thumb]:rounded-full [&::-webkit-scrollbar-track]:bg-transparent\",\n        className\n      )}\n    >\n      <div className=\"space-y-4 px-4 py-4\">\n        {children}\n      </div>\n    </div>\n  )\n}\n\n// Conversation Scroll Button Component\ninterface ConversationScrollButtonProps {\n  className?: string\n  targetRef?: React.RefObject<HTMLElement>\n}\n\nexport function ConversationScrollButton({ className, targetRef }: ConversationScrollButtonProps) {\n  const [showScrollButton, setShowScrollButton] = useState(false)\n  const scrollContainerRef = useRef<HTMLElement | null>(null)\n\n  React.useEffect(() => {\n    const container = targetRef?.current || scrollContainerRef.current?.closest('[class*=\"overflow-y-auto\"]')\n    if (!container) return\n\n    scrollContainerRef.current = container as HTMLElement\n\n    const handleScroll = () => {\n      const { scrollTop, scrollHeight, clientHeight } = container\n      const isNearBottom = scrollHeight - scrollTop - clientHeight < 100\n      setShowScrollButton(!isNearBottom)\n    }\n\n    container.addEventListener('scroll', handleScroll)\n    handleScroll() // Initial check\n\n    return () => container.removeEventListener('scroll', handleScroll)\n  }, [targetRef])\n\n  const scrollToBottom = () => {\n    const container = scrollContainerRef.current\n    if (container) {\n      container.scrollTo({\n        top: container.scrollHeight,\n        behavior: 'smooth'\n      })\n    }\n  }\n\n  if (!showScrollButton) return null\n\n  return (\n    <div className={cn(\"absolute bottom-20 right-4 z-10\", className)}>\n      <Button\n        variant=\"secondary\"\n        size=\"icon\"\n        className=\"h-8 w-8 rounded-full shadow-lg\"\n        onClick={scrollToBottom}\n      >\n        <ArrowDown className=\"h-4 w-4\" />\n      </Button>\n    </div>\n  )\n}\n\n// Message Component (wrapper for individual messages)\ninterface MessageProps {\n  from: 'user' | 'assistant'\n  children: React.ReactNode\n  className?: string\n}\n\nexport function Message({ from, children, className }: MessageProps) {\n  return (\n    <div className={cn(\"message-container\", `message-${from}`, className)}>\n      {children}\n    </div>\n  )\n}\n\n// Message Content Component\ninterface MessageContentProps {\n  children: React.ReactNode\n  className?: string\n}\n\nexport function MessageContent({ children, className }: MessageContentProps) {\n  return (\n    <div className={className}>\n      {children}\n    </div>\n  )\n}\n\n// Message Avatar Component\ninterface MessageAvatarProps {\n  src?: string\n  name?: string\n  className?: string\n}\n\nexport function MessageAvatar({ src, name, className }: MessageAvatarProps) {\n  return (\n    <Avatar className={cn(\"h-8 w-8 rounded-sm\", className)}>\n      <AvatarImage src={src} alt={name} />\n      <AvatarFallback>\n        <User className=\"h-4 w-4\" />\n      </AvatarFallback>\n    </Avatar>\n  )\n}\n\n// Messages Container Component (legacy compatibility)\ninterface ChatMessagesProps {\n  messages: ChatMessage[]\n  isLoading: boolean\n  userAvatar?: string\n  className?: string\n  previousMessages?: ChatMessage[]\n  welcomeContent?: React.ReactNode\n}\n\nexport function ChatMessages({\n  messages,\n  isLoading,\n  userAvatar = \"https://patrickprunty.com/icon.webp\",\n  className,\n  previousMessages = [],\n  welcomeContent,\n}: ChatMessagesProps) {\n  const allMessages = [...previousMessages, ...messages]\n  const hasAnyMessages = allMessages.length > 0\n\n  return (\n    <Conversation className={className}>\n      <ConversationContent>\n        {!hasAnyMessages && (\n          <ChatWelcome>{welcomeContent}</ChatWelcome>\n        )}\n\n        {allMessages.map((message) => {\n          // Render file message first if it exists\n          const elements = []\n          \n          if (message.file && message.role === 'user') {\n            elements.push(\n              <ChatFileMessage\n                key={`${message.id}-file`}\n                file={message.file}\n              />\n            )\n          }\n          \n          // Then render the text message\n          if (message.role === \"user\") {\n            elements.push(\n              <Message key={message.id} from=\"user\">\n                <div className=\"flex flex-row-reverse gap-3\">\n                  <MessageAvatar src={userAvatar} name=\"User\" />\n                  <MessageContent>\n                    <div className=\"bg-primary text-primary-foreground ml-auto max-w-[80%] rounded-lg px-3 py-2\">\n                      <p className=\"text-sm whitespace-pre-wrap\">{message?.content}</p>\n                    </div>\n                  </MessageContent>\n                </div>\n              </Message>\n            )\n          } else {\n            elements.push(\n              <Message key={message.id} from=\"assistant\">\n                <ChatAssistantMessage message={message} />\n              </Message>\n            )\n          }\n          \n          return elements\n        }).flat()}\n\n        {isLoading && (\n          <Message from=\"assistant\">\n            <div className=\"flex gap-3\">\n              <div className=\"w-full\">\n                <div className=\"flex items-center gap-1\">\n                  <div className=\"bg-muted-foreground h-2 w-2 animate-bounce rounded-full\" />\n                  <div\n                    className=\"bg-muted-foreground h-2 w-2 animate-bounce rounded-full\"\n                    style={{ animationDelay: \"0.1s\" }}\n                  />\n                  <div\n                    className=\"bg-muted-foreground h-2 w-2 animate-bounce rounded-full\"\n                    style={{ animationDelay: \"0.2s\" }}\n                  />\n                </div>\n              </div>\n            </div>\n          </Message>\n        )}\n      </ConversationContent>\n      <ConversationScrollButton />\n    </Conversation>\n  )\n}\n\n// PromptInput Component (new structure)\ninterface PromptInputProps {\n  onSubmit: (e: React.FormEvent) => void\n  children: React.ReactNode\n  className?: string\n}\n\nexport function PromptInput({ onSubmit, children, className }: PromptInputProps) {\n  return (\n    <div className={cn(\"px-4 pb-4\", className)} data-chat=\"prompt-input\">\n      <form onSubmit={onSubmit} className=\"space-y-3\">\n        {children}\n      </form>\n    </div>\n  )\n}\n\n// PromptInputTextarea Component\ninterface PromptInputTextareaProps {\n  value: string\n  onChange: (e: React.ChangeEvent<HTMLTextAreaElement>) => void\n  placeholder?: string\n  className?: string\n  attachedFile?: File | null\n  filePreviewUrl?: string | null\n  onRemoveFile?: () => void\n  isDragOver?: boolean\n  onDragOver?: (e: React.DragEvent) => void\n  onDragLeave?: (e: React.DragEvent) => void\n  onDrop?: (e: React.DragEvent) => void\n  allowFileUpload?: boolean\n}\n\nexport function PromptInputTextarea({\n  value,\n  onChange,\n  placeholder = \"How can I help today?\",\n  className,\n  attachedFile,\n  filePreviewUrl,\n  onRemoveFile,\n  isDragOver,\n  onDragOver,\n  onDragLeave,\n  onDrop,\n  allowFileUpload = false,\n}: PromptInputTextareaProps) {\n  const textareaRef = useRef<HTMLTextAreaElement>(null)\n\n  const handleKeyDown = useCallback(\n    (e: React.KeyboardEvent<HTMLTextAreaElement>) => {\n      if (e.key === \"Enter\" && !e.shiftKey) {\n        e.preventDefault()\n        // Let the parent form handle submission\n        const form = e.currentTarget.closest('form')\n        if (form && value.trim()) {\n          const submitEvent = new Event('submit', { bubbles: true, cancelable: true })\n          form.dispatchEvent(submitEvent)\n        }\n        return\n      }\n    },\n    [value]\n  )\n\n  // Calculate dynamic height based on content\n  const dynamicHeight = useMemo(() => {\n    let baseHeight = 140 // min-h-[140px]\n    if (attachedFile) {\n      baseHeight += 80 // Extra height for file preview\n    }\n    return `${baseHeight}px`\n  }, [attachedFile])\n\n  return (\n    <div\n      className={cn(\n        \"relative\",\n        isDragOver && \"ring-primary rounded-xl ring-2 ring-offset-2\"\n      )}\n      onDragOver={onDragOver}\n      onDragLeave={onDragLeave}\n      onDrop={onDrop}\n    >\n      <div className=\"relative\">\n        <Textarea\n          ref={textareaRef}\n          value={value}\n          onChange={onChange}\n          onKeyDown={handleKeyDown}\n          placeholder={\n            attachedFile\n              ? \"Describe what you'd like to do with this file...\"\n              : placeholder\n          }\n          className={cn(\n            \"bg-surface border-input focus:bg-surface resize-none rounded-xl\",\n            allowFileUpload ? \"pr-20 pb-10\" : \"pr-12 pb-10\",\n            attachedFile && \"pt-24\",\n            className\n          )}\n          data-chat=\"textarea\"\n          style={{ minHeight: dynamicHeight }}\n          rows={5}\n        />\n        \n        {attachedFile && (\n          <div className=\"absolute top-2 left-2 z-10\">\n            <div className=\"group relative\">\n              {filePreviewUrl && attachedFile.type.startsWith(\"image/\") ? (\n                // Image preview with natural aspect ratio\n                <div className=\"relative\">\n                  <img\n                    src={filePreviewUrl}\n                    alt={attachedFile.name}\n                    className=\"max-w-[120px] max-h-[80px] rounded-lg border object-cover\"\n                    style={{ aspectRatio: 'auto' }}\n                  />\n                  <Button\n                    type=\"button\"\n                    variant=\"ghost\"\n                    size=\"icon\"\n                    className=\"bg-background hover:bg-muted absolute -top-2 -right-2 h-6 w-6 rounded-full border shadow-sm\"\n                    onClick={onRemoveFile}\n                  >\n                    <X className=\"h-3 w-3\" />\n                  </Button>\n                </div>\n              ) : (\n                // Non-image files with filename and type\n                <div className=\"relative\">\n                  <div className=\"bg-muted/50 flex items-center gap-2 rounded-lg border p-2 pr-8\">\n                    <div className=\"bg-muted-foreground/20 flex h-8 w-8 items-center justify-center rounded\">\n                      <FileText className=\"h-4 w-4\" />\n                    </div>\n                    <div className=\"flex flex-col\">\n                      <span className=\"text-xs font-medium truncate max-w-[80px]\">{attachedFile.name}</span>\n                      <span className=\"text-xs text-muted-foreground uppercase\">\n                        {attachedFile.type.split('/')[1] || 'FILE'}\n                      </span>\n                    </div>\n                  </div>\n                  <Button\n                    type=\"button\"\n                    variant=\"ghost\"\n                    size=\"icon\"\n                    className=\"bg-background hover:bg-muted absolute -top-2 -right-2 h-6 w-6 rounded-full border shadow-sm\"\n                    onClick={onRemoveFile}\n                  >\n                    <X className=\"h-3 w-3\" />\n                  </Button>\n                </div>\n              )}\n            </div>\n          </div>\n        )}\n      </div>\n    </div>\n  )\n}\n\n// PromptInputToolbar Component\ninterface PromptInputToolbarProps {\n  children: React.ReactNode\n  className?: string\n}\n\nexport function PromptInputToolbar({ children, className }: PromptInputToolbarProps) {\n  return (\n    <div className={cn(\"absolute bottom-2 left-2 z-10\", className)}>\n      {children}\n    </div>\n  )\n}\n\n// PromptInputSubmit Component\ninterface PromptInputSubmitProps {\n  disabled?: boolean\n  isLoading?: boolean\n  className?: string\n  allowFileUpload?: boolean\n}\n\nexport function PromptInputSubmit({ disabled, isLoading, className, allowFileUpload = false }: PromptInputSubmitProps) {\n  return (\n    <div className=\"absolute right-2 bottom-2 z-10 flex items-center gap-1\">\n      {allowFileUpload && (\n        <Button\n          type=\"button\"\n          variant=\"ghost\"\n          size=\"icon\"\n          className=\"hover:bg-muted h-8 w-8\"\n          onClick={() => {\n            // Trigger file input\n            const fileInput = document.querySelector('input[type=\"file\"]') as HTMLInputElement\n            fileInput?.click()\n          }}\n        >\n          <Paperclip className=\"text-muted-foreground hover:text-foreground h-4 w-4 transition-colors\" />\n        </Button>\n      )}\n      <ChatSendButton\n        isDisabled={disabled || false}\n        isLoading={isLoading || false}\n        className={className}\n      />\n    </div>\n  )\n}\n\n// Legacy ChatPromptInput Component for backward compatibility\ninterface ChatPromptInputProps {\n  input: string\n  onInputChange: (value: string) => void\n  onSubmit: (e: React.FormEvent) => void\n  isLoading: boolean\n  selectedModel: string\n  onModelChange: (modelId: string) => void\n  models: Model[]\n  className?: string\n  allowFileUpload?: boolean\n  onFileUpload?: (file: File) => void\n  children?: React.ReactNode\n}\n\nexport function ChatPromptInput({\n  input,\n  onInputChange,\n  onSubmit,\n  isLoading,\n  selectedModel,\n  onModelChange,\n  models,\n  className,\n  allowFileUpload = false,\n  onFileUpload,\n  children,\n}: ChatPromptInputProps) {\n  const fileInputRef = useRef<HTMLInputElement>(null)\n  const [attachedFile, setAttachedFile] = useState<File | null>(null)\n  const [filePreviewUrl, setFilePreviewUrl] = useState<string | null>(null)\n  const [isDragOver, setIsDragOver] = useState(false)\n\n  const handleFileSelect = useCallback(\n    (file: File) => {\n      setAttachedFile(file)\n\n      // Create preview URL for images and PDFs\n      if (file.type.startsWith(\"image/\") || file.type === \"application/pdf\") {\n        const url = URL.createObjectURL(file)\n        setFilePreviewUrl(url)\n      } else {\n        setFilePreviewUrl(null)\n      }\n\n      onFileUpload?.(file)\n    },\n    [onFileUpload]\n  )\n\n  const handleFileInputChange = useCallback(\n    (e: React.ChangeEvent<HTMLInputElement>) => {\n      const file = e.target.files?.[0]\n      if (file) {\n        handleFileSelect(file)\n      }\n    },\n    [handleFileSelect]\n  )\n\n  const handleRemoveFile = useCallback(() => {\n    // Clean up preview URL to prevent memory leaks\n    if (filePreviewUrl) {\n      URL.revokeObjectURL(filePreviewUrl)\n      setFilePreviewUrl(null)\n    }\n\n    setAttachedFile(null)\n    if (fileInputRef.current) {\n      fileInputRef.current.value = \"\"\n    }\n  }, [filePreviewUrl])\n\n  const handleDragOver = useCallback(\n    (e: React.DragEvent) => {\n      e.preventDefault()\n      if (allowFileUpload) {\n        setIsDragOver(true)\n      }\n    },\n    [allowFileUpload]\n  )\n\n  const handleDragLeave = useCallback((e: React.DragEvent) => {\n    e.preventDefault()\n    setIsDragOver(false)\n  }, [])\n\n  const handleDrop = useCallback(\n    (e: React.DragEvent) => {\n      e.preventDefault()\n      setIsDragOver(false)\n\n      if (!allowFileUpload) return\n\n      const files = Array.from(e.dataTransfer.files)\n      const file = files[0]\n      if (file) {\n        handleFileSelect(file)\n      }\n    },\n    [allowFileUpload, handleFileSelect]\n  )\n\n  // Cleanup preview URL on unmount\n  React.useEffect(() => {\n    return () => {\n      if (filePreviewUrl) {\n        URL.revokeObjectURL(filePreviewUrl)\n      }\n    }\n  }, [filePreviewUrl])\n\n  return (\n    <PromptInput onSubmit={onSubmit} className={className}>\n      <PromptInputTextarea\n        value={input}\n        onChange={(e) => onInputChange(e.target.value)}\n        attachedFile={attachedFile}\n        filePreviewUrl={filePreviewUrl}\n        onRemoveFile={handleRemoveFile}\n        isDragOver={isDragOver}\n        onDragOver={handleDragOver}\n        onDragLeave={handleDragLeave}\n        onDrop={handleDrop}\n        allowFileUpload={allowFileUpload}\n      />\n      \n      {allowFileUpload && (\n        <input\n          ref={fileInputRef}\n          type=\"file\"\n          className=\"hidden\"\n          onChange={handleFileInputChange}\n          accept=\"*/*\"\n        />\n      )}\n\n      <PromptInputToolbar>\n        {children && (\n          <>\n            {React.Children.map(children, (child) => {\n              // If it's a ChatOptions component, render it with model selector\n              if (React.isValidElement(child) && child.type === ChatOptions) {\n                return (\n                  <div className=\"flex items-center gap-3\">\n                    {(child.props as any).children}\n                    <ChatModelSelector\n                      selectedModel={selectedModel}\n                      onModelChange={onModelChange}\n                      models={models}\n                    />\n                  </div>\n                )\n              }\n              return null\n            })}\n          </>\n        )}\n        {!children && (\n          <ChatModelSelector\n            selectedModel={selectedModel}\n            onModelChange={onModelChange}\n            models={models}\n          />\n        )}\n      </PromptInputToolbar>\n\n      <div className=\"absolute right-2 bottom-2 z-10 flex items-center gap-1\">\n        {allowFileUpload && (\n          <Button\n            type=\"button\"\n            variant=\"ghost\"\n            size=\"icon\"\n            className=\"hover:bg-muted h-8 w-8\"\n            onClick={() => fileInputRef.current?.click()}\n          >\n            <Paperclip className=\"text-muted-foreground hover:text-foreground h-4 w-4 transition-colors\" />\n          </Button>\n        )}\n        <PromptInputSubmit\n          disabled={!input.trim()}\n          isLoading={isLoading}\n        />\n      </div>\n    </PromptInput>\n  )\n}\n",
      "type": "registry:ui"
    }
  ]
}